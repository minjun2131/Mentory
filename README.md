![Group 19](https://github.com/user-attachments/assets/0a6abaee-3423-4a51-8606-3c381b50e8ba)


# 💻 MENTORY: 예비 개발자를 위한 취업 컨설팅 플랫폼

**MENTORY**는 개발자를 꿈꾸는 예비 개발자들을 위해 설계된 취업 컨설팅 플랫폼입니다.<br/><br/>
**사용자는 멘토와 직접 1:1 채팅을 통해 멘토링 상담 일정을 조율할 수 있습니다.**

---

### **팀 구성**
| 김호준                                                   | 박상기                                                   | 엄정은                                                   | 문다슬                                                   | 최혜진                                                   |
|----------------------------------------------------------|----------------------------------------------------------|----------------------------------------------------------|----------------------------------------------------------|----------------------------------------------------------|
| <div align="center">[<img src="https://github.com/minjun2131.png" width="100" height="100">](https://github.com/minjun2131)</div> | <div align="center">[<img src="https://github.com/adorable-otter.png" width="100" height="100">](https://github.com/adorable-otter)</div> | <div align="center">[<img src="https://github.com/ovezen.png" width="100" height="100">](https://github.com/ovezen)</div> | <div align="center">[<img src="https://github.com/Raina-Moon.png" width="100" height="100">](https://github.com/Raina-Moon)</div> | <div align="center">[<img src="https://github.com/choihyejin94.png" width="100" height="100">](https://github.com/choihyejin94)</div> |
| <div align="center">팀장</div>                             | <div align="center">팀원</div>                             | <div align="center">팀원</div>                             | <div align="center">팀원</div>                             | <div align="center">팀원</div>                             |
| <div align="center">상세 페이지,<br/>마이 페이지</div>       | <div align="center">멘토 등록 폼</div>                     | <div align="center">채팅 시스템</div>                       | <div align="center">Supabase auth 관리,<br/> 로그인-회원가입 폼,<br/>헤더-푸터 레이아웃</div> | <div align="center">채팅 시스템</div>                       |

---
 
### **기술 스택**

![React](https://img.shields.io/badge/React-61DAFB?logo=react&logoColor=white&style=for-the-badge)
![TypeScript](https://img.shields.io/badge/TypeScript-3178C6?logo=typescript&logoColor=white&style=for-the-badge)
![Supabase](https://img.shields.io/badge/Supabase-3ECF8E?logo=supabase&logoColor=white&style=for-the-badge)
![Next.js](https://img.shields.io/badge/Next.js-000000?logo=nextdotjs&logoColor=white&style=for-the-badge)
![Tailwind CSS](https://img.shields.io/badge/TailwindCSS-06B6D4?logo=tailwindcss&logoColor=white&style=for-the-badge)
![React Hook Form](https://img.shields.io/badge/React_Hook_Form-EC5990?logo=reacthookform&logoColor=white&style=for-the-badge)
![Shadcn](https://img.shields.io/badge/Shadcn-121212?logo=shadcn&logoColor=white&style=for-the-badge)
![Zustand](https://img.shields.io/badge/Zustand-FFC107?logo=zustand&logoColor=white&style=for-the-badge)

---
### **💬 프로젝트 기획**

캠프를 수료하고 났을 때, 개발자 취업이나 멘토링을 받아보고 싶을 때 어떻게 해야 할지 막막하다고 생각했습니다.<br/>
그래서 가고 싶은 회사, 원하는 직무 등 내가 필요로 하는 궁금증에 대해 멘토에게 자세히 상담받을 수 있는 서비스를 제공하고자 기획하였습니다.

---


### **기능 설명**

#### **홈페이지**
- **멘토 소개 섹션**: 다양한 멘토를 소개하며 멘토 리스트로 이동하는 버튼 제공.
- **검색 UI**: 사용자가 원하는 멘토를 쉽게 찾을 수 있는 인터페이스.
- **Skeleton**: 로딩 상태에서도 자연스러운 사용자 경험 제공.

#### **멘토 리스트**
![멘토디테일](https://github.com/user-attachments/assets/0ab9c7b2-f9b8-4c5e-8698-c2ddd67eb641)

- **멘토 목록 표시**: 모든 멘토를 한눈에 볼 수 있는 리스트 형태.
- **간략 정보 제공**: 각 멘토의 주요 정보 표시.
- **상세 페이지 이동**: 특정 멘토를 선택하면 상세 페이지로 이동.

#### **상세 페이지**
![멘토디테일](https://github.com/user-attachments/assets/75ebed81-703c-446b-a33c-91a0ce98ae8b)

- **멘토 경력 소개**: 선택한 멘토의 전문성과 경력을 상세히 소개.
- **1:1 채팅 버튼**: 멘토와 즉시 소통 가능한 버튼 제공.

#### **마이페이지**
![프로필이미지변경](https://github.com/user-attachments/assets/d93e5767-0f2b-422f-a707-2e8d15f475cd)

- **프로필 관리**: 프로필 사진 및 이름 변경 가능.
- **멘토 신청**: 멘토로 등록할 수 있는 신청 버튼 제공.
- **로그아웃**: 간편한 로그아웃 기능 제공.

#### **멘토 등록**
![멘토신청](https://github.com/user-attachments/assets/289547ae-c0ef-4536-b713-4d2df5dd3a7a)

- **자기소개 작성**: 자신의 정보를 등록하여 멘토 활동 시작.
- **프로필 사진 업로드**: 사용자 이미지 업로드 가능.
- **경력 입력**: 상세 경력 정보 제공.
- **해시태그 등록**: 멘토의 전문 분야를 표현할 해시태그 저장.

#### **로그인 / 회원가입**
![로그인](https://github.com/user-attachments/assets/7c1a5c39-92a7-45a6-aaac-0585937c9133)

- **모달 창 관리**: 로그인 및 회원가입을 위한 모달 창 제공.
- **유효성 검사**: 입력된 정보의 실시간 검사 기능.
- ![깃헙로그인](https://github.com/user-attachments/assets/de55890e-a4a9-4ed4-a81c-df245dacafb6)

- **GitHub 로그인**: GitHub 계정을 활용한 간편 로그인 제공.

#### **채팅방**
![채팅](https://github.com/user-attachments/assets/8445b716-0a0e-4675-a32c-1d76e15c0861)
- **채팅방 열기/닫기**: 플로팅 버튼을 통해 간편하게 채팅방 제어.
- **메시지 입력 및 전송**: 실시간 메시지 전송 및 수신.
- **상대방 정보 표시**: 상대방 프로필 및 이름 제공.
- **채팅 리스트**: 기존 대화 상대와의 대화창 목록 제공.

---

### **🛠  Trouble Shooting**

### ✅ Mentor Funnel 
* 멘토 등록 시에 사용자애게 요구되는 많은 양의 입력 데이터 입력 부담을 완화하고,<br/>
조금 더 사용자 친화적인 UI를 제공하기 위해 퍼널 패턴을 적용<br/>
패널 패턴은 사용자에게 한 번에 모든 데이터 입력을 요구하지 않고,<br/>
한 화면에서 하나 또는 최소한의 데이터 입력을 받은 후 다음 화면으로 넘어가 데이터 입력을 반복하는 플로우를 제공

```javascript
if (e.key === ‘Enter’) {
    e.preventDefault();
    if (!isComposing) {
     handleSendMessage();
    }
   }

```

### ✅ 한글 채팅 입력 시 메시지 중복 전송 문제
* 문제점: 한글 입력 시 조합 중에 'Enter' 키를 누르면 메시지가 중복으로 전송되는 문제 발생
* 해결과정 : 처음에는 이 문제를 발견하지 못했는데 팀원분들의 도움으로 문제 발생과 문제의 원인을 파악했습니다. GPT에게 질문을 해보았으나 원하는 답변을 얻지 못했고, 구글링을 통해 저와 같은 문제를 겪고 있는 사람을 발견했습니다. 이후 코드 분석을 통해 해결 방안을 마련하고, 트러블슈팅 과정 중 리팩토링을 진행하여 코드를 수정하였습니다.
* 해결방법 : isComposing 변수를 사용하여 현재 입력이 조합 중인지 확인하고, 조합 중일 경우 'Enter' 키 이벤트를 취소하여 메시지 전송을 방지한다.
```javascript
const handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {
if (e.key === ‘Enter’) {
    e.preventDefault();
    if (!isComposing) {
     handleSendMessage();
    }
   }
```
* 결과 : 전송 버튼 또는 'Enter' 키를 사용하여 한글 메시지를 전송할 때, 한글 조합 중 발생하는 오류로 인한 중복 전송을 방지할 수 있게 되었습니다. 
---

### ✅ Supabase 실시간 데이터 타입 불일치 문제
* 문제: payload.new의 타입이 Message와 맞지 않아 TypeScript 에러 발생.<br/>
* 원인: Supabase의 실시간 이벤트에서 반환된 데이터(payload.new)는 기본적으로 any 타입으로 처리되며, 정의된 Message 타입과 불일치.<br/>
* Supabase에서 반환된 데이터 타입을 명시적으로 캐스팅해줌.
```javascript
const message = payload.new as Message;
```
### ✅ Supabase-React 채팅 메시지 순서 문제 해결
* 문제: 채팅 모달을 닫았다가 다시 열면 메시지 순서가 뒤섞임. Supabase에서 메시지를 가져오는 과정과 실시간 업데이트 로직에서 발생한 문제로 생각됨.<br/>
* 원인: fetchMessages 함수에서 Supabase 쿼리에 명시적인 order 조건이 빠져 있음. Supabase는 기본적으로 데이터를 삽입된 순서대로 반환하지 않을 수 있음.<br/>
  또한 새 메시지가 추가될 때 기존 상태 배열에 단순히 추가만 되고 있어 기존에 잘못된 순서로 로드된 메시지와 섞일 가능성이 있음.
* 메시지를 가져올 때 created_at 기준으로 정렬 추가함.
```javascript
const { data, error } = await supabase
  .from('messages')
  .select('*, users(*)')
  .eq('chatroom_id', chatroomId)
  .order('created_at', { ascending: true });
```
* 실시간 메시지가 추가될 때 기존 배열과 섞이지 않도록, 업데이트 시 정렬 로직 추가.

```javascript
const channel = supabase
  .channel(`messages:chatroom_id=eq.${chatroomId}`)
  .on(
    'postgres_changes',
    { event: 'INSERT', schema: 'public', table: 'messages', filter: `chatroom_id=eq.${chatroomId}` },
    (payload) => {
      const newMessage = payload.new as Message;
      setMessages((prev) =>
        [...prev, newMessage].sort(
          (a, b) => new Date(a.created_at).getTime() - new Date(b.created_at).getTime()
        )
      );
    }
  )
  .subscribe();
```
### ✅  채팅 스크롤 자동 최하단 이동
* 문제: 채팅 화면에서 새로운 메시지가 추가되거나, 컴포넌트가 처음 렌더링될 때 메시지 리스트가 자동으로 최하단으로 스크롤되지 않음. 사용자 경험 문제.
* useRef를 활용한 메시지 리스트 끝부분 참조 생성
```javascript
const messageEndRef = useRef<HTMLDivElement | null>(null);

// ----- (중략) ----- //

useEffect(() => {
  if (messageEndRef.current) {
    messageEndRef.current.scrollIntoView({ behavior: 'smooth' });
  }
}, [messages]); // messages가 변경될 때마다 실행
```
* behavior 옵션에 따라 smooth, auto 등 스크롤 속도 변경 가능!

---
### 🥇  프로젝트에서 배운점

* Next.js로 처음 프로젝트를 기획 및 개발을 시작하는 단계에서,<br/>
  컨벤션과 규칙들을 정하는 과정에서 폴더 컨벤션에 대해서 생각보다 시간이 오래 잡아먹혔다.<br/>
  그래서 시간을 오래 썼음에도 피드백에서 한번 더 생각해볼 것을 권장하셨고, 폴더 컨벤션이 오래 걸리는 이유를 느꼈습니다.

* 특히 이번 프로젝트에 대한 피드백이 Next.js의 이점을 많이 살리지 못했는데<br/>
  다음 부분에서는 그 장점을 더 어떻게 살릴 수 있는지에 대한 고민도 필요해보인다.

* 이번 프로젝트에서 조금 추가하고 싶은 기능들이 더 있었고<br/>
  그 부분의 추가를 하기보단 기존 것을 완성도 높게 완성하자는 목표가 있었기에<br/>
  다음에 기회가 된다면 리팩토링을 거쳐 마저 기능들을 추가해 서비스를 완성해보고 싶은 생각이였습니다.

---

### **💾 ERD**
![_______________________________2024-12-30_________________11 00 27](https://github.com/user-attachments/assets/c73d0a3d-948d-48f8-88e0-003e8c82684c)

---

### **폴더 구조**

```plaintext
src
 ┣ app
 ┃ ┣ api
 ┃ ┃ ┗ auth
 ┃ ┣ fonts
 ┃ ┣ mentor-list
 ┃ ┃ ┣ [id]
 ┃ ┣ mentors
 ┃ ┃ ┗ new
 ┃ ┃ ┃ ┣ _components
 ┃ ┣ mypage
 ┃ ┃ ┣ _components
 ┃ ┃ ┣ _hooks
 ┃ ┃ ┣ _lib
 ┃ ┃ ┣ edit
 ┣ components
 ┣ hooks
 ┣ lib
 ┣ store
 ┣ types
 ┣ utils
```

